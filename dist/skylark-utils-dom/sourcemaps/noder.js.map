{"version":3,"sources":["noder.js"],"names":["define","dom","langx","browser","styler","ensureNodes","nodes","copyByClone","isArrayLike","map","call","node","cloneNode","flatten","nodeName","elm","chkName","name","toLowerCase","undefined","activeElement","doc","document","el","error","body","after","placing","refNode","parent","parentNode","nextSibling","i","length","insertBefore","appendChild","this","append","before","contents","contentDocument","childNodes","createElement","tag","props","setAttribute","createFragment","html","trim","singleTagRE","test","RegExp","$1","fragmentRE","containers","container","innerHTML","slice","forEach","removeChild","clone","deep","self","isIE","nodeType","each","getAttribs","attr","setAttrib","getAttrib","contains","child","isChildOf","createTextNode","text","empty","hasChildNodes","firstChild","fullScreen","exitFullScreen","apply","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","requestFullScreen","fulledEl","focusable","element","hasTabindex","mapName","img","focusableIfVisible","fieldset","href","$","is","disabled","closest","visible","isString","replace","rxhtmlTag","isNumber","directly","documentElement","isDoc","DOCUMENT_NODE","ownerDoc","ownerDocument","ownerWindow","defaultView","parentWindow","prepend","offsetParent","rootNodeRE","css","overlay","params","overlayDiv","position","top","left","width","height","zIndex","opacity","remove","e","console","warn","children","oldNode","replaceChild","throb","timer","style","time","callback","throbber","className","textNode","clearTimeout","update","nodeValue","end","setTimeout","traverse","fn","len","reverse","wrapper","wrapperNode","wrapperInner","unwrap","noder","navigator","userAgent","match","div","table","tableBody","tableRow","tr","tbody","thead","tfoot","td","th","*","Array","prototype","mixin","active","blur","isWindow"],"mappings":"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","file":"../noder.js","sourcesContent":["define([\r\n    \"./dom\",\r\n    \"./langx\",\r\n    \"./browser\",\r\n    \"./styler\"\r\n], function(dom, langx, browser, styler) {\r\n    var isIE = !!navigator.userAgent.match(/Trident/g) || !!navigator.userAgent.match(/MSIE/g),\r\n        fragmentRE = /^\\s*<(\\w+|!)[^>]*>/,\r\n        singleTagRE = /^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,\r\n        div = document.createElement(\"div\"),\r\n        table = document.createElement('table'),\r\n        tableBody = document.createElement('tbody'),\r\n        tableRow = document.createElement('tr'),\r\n        containers = {\r\n            'tr': tableBody,\r\n            'tbody': table,\r\n            'thead': table,\r\n            'tfoot': table,\r\n            'td': tableRow,\r\n            'th': tableRow,\r\n            '*': div\r\n        },\r\n        rootNodeRE = /^(?:body|html)$/i,\r\n        map = Array.prototype.map,\r\n        slice = Array.prototype.slice;\r\n\r\n    function ensureNodes(nodes, copyByClone) {\r\n        if (!langx.isArrayLike(nodes)) {\r\n            nodes = [nodes];\r\n        }\r\n        if (copyByClone) {\r\n            nodes = map.call(nodes, function(node) {\r\n                return node.cloneNode(true);\r\n            });\r\n        }\r\n        return langx.flatten(nodes);\r\n    }\r\n\r\n    function nodeName(elm, chkName) {\r\n        var name = elm.nodeName && elm.nodeName.toLowerCase();\r\n        if (chkName !== undefined) {\r\n            return name === chkName.toLowerCase();\r\n        }\r\n        return name;\r\n    };\r\n\r\n\r\n    function activeElement(doc) {\r\n        doc = doc || document;\r\n        var el;\r\n\r\n        // Support: IE 9 only\r\n        // IE9 throws an \"Unspecified error\" accessing document.activeElement from an <iframe>\r\n        try {\r\n            el = doc.activeElement;\r\n        } catch ( error ) {\r\n            el = doc.body;\r\n        }\r\n\r\n        // Support: IE 9 - 11 only\r\n        // IE may return null instead of an element\r\n        // Interestingly, this only seems to occur when NOT in an iframe\r\n        if ( !el ) {\r\n            el = doc.body;\r\n        }\r\n\r\n        // Support: IE 11 only\r\n        // IE11 returns a seemingly empty object in some cases when accessing\r\n        // document.activeElement from an <iframe>\r\n        if ( !el.nodeName ) {\r\n            el = doc.body;\r\n        }\r\n\r\n        return el;\r\n    };\r\n\r\n    function after(node, placing, copyByClone) {\r\n        var refNode = node,\r\n            parent = refNode.parentNode;\r\n        if (parent) {\r\n            var nodes = ensureNodes(placing, copyByClone),\r\n                refNode = refNode.nextSibling;\r\n\r\n            for (var i = 0; i < nodes.length; i++) {\r\n                if (refNode) {\r\n                    parent.insertBefore(nodes[i], refNode);\r\n                } else {\r\n                    parent.appendChild(nodes[i]);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function append(node, placing, copyByClone) {\r\n        var parentNode = node,\r\n            nodes = ensureNodes(placing, copyByClone);\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            parentNode.appendChild(nodes[i]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function before(node, placing, copyByClone) {\r\n        var refNode = node,\r\n            parent = refNode.parentNode;\r\n        if (parent) {\r\n            var nodes = ensureNodes(placing, copyByClone);\r\n            for (var i = 0; i < nodes.length; i++) {\r\n                parent.insertBefore(nodes[i], refNode);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /*   \r\n     * Get the children of the specified node, including text and comment nodes.\r\n     * @param {HTMLElement} elm\r\n     */\r\n    function contents(elm) {\r\n        if (nodeName(elm, \"iframe\")) {\r\n            return elm.contentDocument;\r\n        }\r\n        return elm.childNodes;\r\n    }\r\n\r\n    /*   \r\n     * Create a element and set attributes on it.\r\n     * @param {HTMLElement} tag\r\n     * @param {props} props\r\n     * @param } parent\r\n     */\r\n    function createElement(tag, props, parent) {\r\n        var node = document.createElement(tag);\r\n        if (props) {\r\n            for (var name in props) {\r\n                node.setAttribute(name, props[name]);\r\n            }\r\n        }\r\n        if (parent) {\r\n            append(parent, node);\r\n        }\r\n        return node;\r\n    }\r\n\r\n    /*   \r\n     * Create a DocumentFragment from the HTML fragment.\r\n     * @param {String} html\r\n     */\r\n    function createFragment(html) {\r\n        // A special case optimization for a single tag\r\n        html = langx.trim(html);\r\n        if (singleTagRE.test(html)) {\r\n            return [createElement(RegExp.$1)];\r\n        }\r\n\r\n        var name = fragmentRE.test(html) && RegExp.$1\r\n        if (!(name in containers)) {\r\n            name = \"*\"\r\n        }\r\n        var container = containers[name];\r\n        container.innerHTML = \"\" + html;\r\n        dom = slice.call(container.childNodes);\r\n\r\n        dom.forEach(function(node) {\r\n            container.removeChild(node);\r\n        })\r\n\r\n        return dom;\r\n    }\r\n\r\n    /*   \r\n     * Create a deep copy of the set of matched elements.\r\n     * @param {HTMLElement} node\r\n     * @param {Boolean} deep\r\n     */\r\n    function clone(node, deep) {\r\n        var self = this,\r\n            clone;\r\n\r\n        // TODO: Add feature detection here in the future\r\n        if (!isIE || node.nodeType !== 1 || deep) {\r\n            return node.cloneNode(deep);\r\n        }\r\n\r\n        // Make a HTML5 safe shallow copy\r\n        if (!deep) {\r\n            clone = document.createElement(node.nodeName);\r\n\r\n            // Copy attribs\r\n            each(self.getAttribs(node), function(attr) {\r\n                self.setAttrib(clone, attr.nodeName, self.getAttrib(node, attr.nodeName));\r\n            });\r\n\r\n            return clone;\r\n        }\r\n    }\r\n\r\n    /*   \r\n     * Check to see if a dom node is a descendant of another dom node .\r\n     * @param {String} node\r\n     * @param {Node} child\r\n     */\r\n    function contains(node, child) {\r\n        return isChildOf(child, node);\r\n    }\r\n\r\n    /*   \r\n     * Create a new Text node.\r\n     * @param {String} text\r\n     * @param {Node} child\r\n     */\r\n    function createTextNode(text) {\r\n        return document.createTextNode(text);\r\n    }\r\n\r\n    /*   \r\n     * Get the current document object.\r\n     */\r\n    function doc() {\r\n        return document;\r\n    }\r\n\r\n    /*   \r\n     * Remove all child nodes of the set of matched elements from the DOM.\r\n     * @param {Object} node\r\n     */\r\n    function empty(node) {\r\n        while (node.hasChildNodes()) {\r\n            var child = node.firstChild;\r\n            node.removeChild(child);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    var fulledEl = null;\r\n\r\n    function fullScreen(el) {\r\n        if (el === false) {\r\n            browser.exitFullScreen.apply(document);\r\n        } else if (el) {\r\n            browser.requestFullScreen.apply(el);\r\n            fulledEl = el;\r\n        } else {\r\n            return (\r\n                document.fullscreenElement ||\r\n                document.webkitFullscreenElement ||\r\n                document.mozFullScreenElement ||\r\n                document.msFullscreenElement\r\n            )\r\n        }\r\n    }\r\n\r\n\r\n    // Selectors\r\n    function focusable( element, hasTabindex ) {\r\n        var map, mapName, img, focusableIfVisible, fieldset,\r\n            nodeName = element.nodeName.toLowerCase();\r\n\r\n        if ( \"area\" === nodeName ) {\r\n            map = element.parentNode;\r\n            mapName = map.name;\r\n            if ( !element.href || !mapName || map.nodeName.toLowerCase() !== \"map\" ) {\r\n                return false;\r\n            }\r\n            img = $( \"img[usemap='#\" + mapName + \"']\" );\r\n            return img.length > 0 && img.is( \":visible\" );\r\n        }\r\n\r\n        if ( /^(input|select|textarea|button|object)$/.test( nodeName ) ) {\r\n            focusableIfVisible = !element.disabled;\r\n\r\n            if ( focusableIfVisible ) {\r\n\r\n                // Form controls within a disabled fieldset are disabled.\r\n                // However, controls within the fieldset's legend do not get disabled.\r\n                // Since controls generally aren't placed inside legends, we skip\r\n                // this portion of the check.\r\n                fieldset = $( element ).closest( \"fieldset\" )[ 0 ];\r\n                if ( fieldset ) {\r\n                    focusableIfVisible = !fieldset.disabled;\r\n                }\r\n            }\r\n        } else if ( \"a\" === nodeName ) {\r\n            focusableIfVisible = element.href || hasTabindex;\r\n        } else {\r\n            focusableIfVisible = hasTabindex;\r\n        }\r\n\r\n        return focusableIfVisible && $( element ).is( \":visible\" ) && visible( $( element ) );\r\n    };\r\n\r\n\r\n   var rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi;\r\n \r\n    /*   \r\n     * Get the HTML contents of the first element in the set of matched elements.\r\n     * @param {HTMLElement} node\r\n     * @param {String} html\r\n     */\r\n    function html(node, html) {\r\n        if (html === undefined) {\r\n            return node.innerHTML;\r\n        } else {\r\n            this.empty(node);\r\n            html = html || \"\";\r\n            if (langx.isString(html)) {\r\n                html = html.replace( rxhtmlTag, \"<$1></$2>\" );\r\n            }\r\n            if (langx.isString(html) || langx.isNumber(html)) {               \r\n                node.innerHTML = html;\r\n            } else if (langx.isArrayLike(html)) {\r\n                for (var i = 0; i < html.length; i++) {\r\n                    node.appendChild(html[i]);\r\n                }\r\n            } else {\r\n                node.appendChild(html);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /*   \r\n     * Check to see if a dom node is a descendant of another dom node.\r\n     * @param {Node} node\r\n     * @param {Node} parent\r\n     * @param {Node} directly\r\n     */\r\n    function isChildOf(node, parent, directly) {\r\n        if (directly) {\r\n            return node.parentNode === parent;\r\n        }\r\n        if (document.documentElement.contains) {\r\n            return parent.contains(node);\r\n        }\r\n        while (node) {\r\n            if (parent === node) {\r\n                return true;\r\n            }\r\n\r\n            node = node.parentNode;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /*   \r\n     * Check to see if a dom node is a descendant of another dom node.\r\n     * @param {Node} node\r\n     * @param {Node} parent\r\n     * @param {Node} directly\r\n     */\r\n    function isDoc(node) {\r\n        return node != null && node.nodeType == node.DOCUMENT_NODE\r\n    }\r\n\r\n    /*   \r\n     * Get the owner document object for the specified element.\r\n     * @param {Node} elm\r\n     */\r\n    function ownerDoc(elm) {\r\n        if (!elm) {\r\n            return document;\r\n        }\r\n\r\n        if (elm.nodeType == 9) {\r\n            return elm;\r\n        }\r\n\r\n        return elm.ownerDocument;\r\n    }\r\n\r\n    /*   \r\n     *\r\n     * @param {Node} elm\r\n     */\r\n    function ownerWindow(elm) {\r\n        var doc = ownerDoc(elm);\r\n        return doc.defaultView || doc.parentWindow;\r\n    }\r\n\r\n    /*   \r\n     * insert one or more nodes as the first children of the specified node.\r\n     * @param {Node} node\r\n     * @param {Node or ArrayLike} placing\r\n     * @param {Boolean Optional} copyByClone\r\n     */\r\n    function prepend(node, placing, copyByClone) {\r\n        var parentNode = node,\r\n            refNode = parentNode.firstChild,\r\n            nodes = ensureNodes(placing, copyByClone);\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            if (refNode) {\r\n                parentNode.insertBefore(nodes[i], refNode);\r\n            } else {\r\n                parentNode.appendChild(nodes[i]);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /*   \r\n     *\r\n     * @param {Node} elm\r\n     */\r\n    function offsetParent(elm) {\r\n        var parent = elm.offsetParent || document.body;\r\n        while (parent && !rootNodeRE.test(parent.nodeName) && styler.css(parent, \"position\") == \"static\") {\r\n            parent = parent.offsetParent;\r\n        }\r\n        return parent;\r\n    }\r\n\r\n    /*   \r\n     *\r\n     * @param {Node} elm\r\n     * @param {Node} params\r\n     */\r\n    function overlay(elm, params) {\r\n        var overlayDiv = createElement(\"div\", params);\r\n        styler.css(overlayDiv, {\r\n            position: \"absolute\",\r\n            top: 0,\r\n            left: 0,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            zIndex: 0x7FFFFFFF,\r\n            opacity: 0.7\r\n        });\r\n        elm.appendChild(overlayDiv);\r\n        return overlayDiv;\r\n\r\n    }\r\n\r\n    /*   \r\n     * Remove the set of matched elements from the DOM.\r\n     * @param {Node} node\r\n     */\r\n    function remove(node) {\r\n        if (node && node.parentNode) {\r\n            try {\r\n                node.parentNode.removeChild(node);\r\n            } catch (e) {\r\n                console.warn(\"The node is already removed\", e);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function removeChild(node,children) {\r\n        if (!langx.isArrayLike(children)) {\r\n            children = [children];\r\n        }\r\n        for (var i=0;i<children.length;i++) {\r\n            node.removeChild(children[i]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    function scrollParent( elm, includeHidden ) {\r\n        var position = styler.css(elm,\"position\" ),\r\n            excludeStaticParent = position === \"absolute\",\r\n            overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,\r\n            scrollParent = this.parents().filter( function() {\r\n                var parent = $( this );\r\n                if ( excludeStaticParent && parent.css( \"position\" ) === \"static\" ) {\r\n                    return false;\r\n                }\r\n                return overflowRegex.test( parent.css( \"overflow\" ) + parent.css( \"overflow-y\" ) +\r\n                    parent.css( \"overflow-x\" ) );\r\n            } ).eq( 0 );\r\n\r\n        return position === \"fixed\" || !scrollParent.length ?\r\n            $( this[ 0 ].ownerDocument || document ) :\r\n            scrollParent;\r\n    };\r\n\r\n        /*   \r\n     * Replace an old node with the specified node.\r\n     * @param {Node} node\r\n     * @param {Node} oldNode\r\n     */\r\n    function replace(node, oldNode) {\r\n        oldNode.parentNode.replaceChild(node, oldNode);\r\n        return this;\r\n    }\r\n\r\n    /*   \r\n     * Replace an old node with the specified node.\r\n     * @param {HTMLElement} elm\r\n     * @param {Node} params\r\n     */\r\n    function throb(elm, params) {\r\n        params = params || {};\r\n        var self = this,\r\n            text = params.text,\r\n            style = params.style,\r\n            time = params.time,\r\n            callback = params.callback,\r\n            timer,\r\n            throbber = this.createElement(\"div\", {\r\n                className: params.className || \"throbber\",\r\n                style: style\r\n            }),\r\n            _overlay = overlay(throbber, {\r\n                className: 'overlay fade'\r\n            }),\r\n            throb = this.createElement(\"div\", {\r\n                className: \"throb\"\r\n            }),\r\n            textNode = this.createTextNode(text || \"\"),\r\n            remove = function() {\r\n                if (timer) {\r\n                    clearTimeout(timer);\r\n                    timer = null;\r\n                }\r\n                if (throbber) {\r\n                    self.remove(throbber);\r\n                    throbber = null;\r\n                }\r\n            },\r\n            update = function(params) {\r\n                if (params && params.text && throbber) {\r\n                    textNode.nodeValue = params.text;\r\n                }\r\n            };\r\n        throb.appendChild(textNode);\r\n        throbber.appendChild(throb);\r\n        elm.appendChild(throbber);\r\n        var end = function() {\r\n            remove();\r\n            if (callback) callback();\r\n        };\r\n        if (time) {\r\n            timer = setTimeout(end, time);\r\n        }\r\n\r\n        return {\r\n            remove: remove,\r\n            update: update\r\n        };\r\n    }\r\n\r\n\r\n    /*   \r\n     * traverse the specified node and its descendants, perform the callback function on each\r\n     * @param {Node} node\r\n     * @param {Function} fn\r\n     */\r\n    function traverse(node, fn) {\r\n        fn(node)\r\n        for (var i = 0, len = node.childNodes.length; i < len; i++) {\r\n            traverse(node.childNodes[i], fn);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /*   \r\n     *\r\n     * @param {Node} node\r\n     */\r\n    function reverse(node) {\r\n        var firstChild = node.firstChild;\r\n        for (var i = node.children.length - 1; i > 0; i--) {\r\n            if (i > 0) {\r\n                var child = node.children[i];\r\n                node.insertBefore(child, firstChild);\r\n            }\r\n        }\r\n    }\r\n\r\n    /*   \r\n     * Wrap an HTML structure around each element in the set of matched elements.\r\n     * @param {Node} node\r\n     * @param {Node} wrapperNode\r\n     */\r\n    function wrapper(node, wrapperNode) {\r\n        if (langx.isString(wrapperNode)) {\r\n            wrapperNode = this.createFragment(wrapperNode).firstChild;\r\n        }\r\n        node.parentNode.insertBefore(wrapperNode, node);\r\n        wrapperNode.appendChild(node);\r\n    }\r\n\r\n    /*   \r\n     * Wrap an HTML structure around the content of each element in the set of matched\r\n     * @param {Node} node\r\n     * @param {Node} wrapperNode\r\n     */\r\n    function wrapperInner(node, wrapperNode) {\r\n        var childNodes = slice.call(node.childNodes);\r\n        node.appendChild(wrapperNode);\r\n        for (var i = 0; i < childNodes.length; i++) {\r\n            wrapperNode.appendChild(childNodes[i]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /*   \r\n     * Remove the parents of the set of matched elements from the DOM, leaving the matched\r\n     * @param {Node} node\r\n     */\r\n    function unwrap(node) {\r\n        var child, parent = node.parentNode;\r\n        if (parent) {\r\n            if (this.isDoc(parent.parentNode)) return;\r\n            parent.parentNode.insertBefore(node, parent);\r\n        }\r\n    }\r\n\r\n    function noder() {\r\n        return noder;\r\n    }\r\n\r\n    langx.mixin(noder, {\r\n        active  : activeElement,\r\n\r\n        blur : function(el) {\r\n            el.blur();\r\n        },\r\n\r\n        body: function() {\r\n            return document.body;\r\n        },\r\n\r\n        clone: clone,\r\n        contents: contents,\r\n\r\n        createElement: createElement,\r\n\r\n        createFragment: createFragment,\r\n\r\n        contains: contains,\r\n\r\n        createTextNode: createTextNode,\r\n\r\n        doc: doc,\r\n\r\n        empty: empty,\r\n\r\n        fullScreen: fullScreen,\r\n\r\n        focusable: focusable,\r\n\r\n        html: html,\r\n\r\n        isChildOf: isChildOf,\r\n\r\n        isDoc: isDoc,\r\n\r\n        isWindow: langx.isWindow,\r\n\r\n        offsetParent: offsetParent,\r\n\r\n        ownerDoc: ownerDoc,\r\n\r\n        ownerWindow: ownerWindow,\r\n\r\n        after: after,\r\n\r\n        before: before,\r\n\r\n        prepend: prepend,\r\n\r\n        append: append,\r\n\r\n        remove: remove,\r\n\r\n        removeChild : removeChild,\r\n\r\n        replace: replace,\r\n\r\n        throb: throb,\r\n\r\n        traverse: traverse,\r\n\r\n        reverse: reverse,\r\n\r\n        wrapper: wrapper,\r\n\r\n        wrapperInner: wrapperInner,\r\n\r\n        unwrap: unwrap\r\n    });\r\n\r\n    return dom.noder = noder;\r\n});"]}