/**
 * skylark-utils-dom - An Elegant HTML5 DOM utility Library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./dom","./langx","./noder","./styler"],function(t,i,e,o){function n(){if(void 0!==R)return R;var t,i,n=e.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],l=n.childNodes[0];return e.append(document.body,n),t=l.offsetWidth,o.css(n,"overflow","scroll"),i=l.offsetWidth,t===i&&(i=n[0].clientWidth),e.remove(n),R=t-i}function l(t){if(e.isWindow(t))return{left:0,top:0,right:0,bottom:0};var i=getComputedStyle(t);return{left:C(i.borderLeftWidth,t),top:C(i.borderTopWidth,t),right:C(i.borderRightWidth,t),bottom:C(i.borderBottomWidth,t)}}function h(t,i){if(void 0===i)return B.test(t.nodeName)?{top:0,left:0}:t.getBoundingClientRect();var e=D(t),o=h(e),n=a(t),r=l(e);return b(t,{top:i.top-o.top-n.top-r.top,left:i.left-o.left-n.left-r.left}),this}function r(t,i){return void 0===i?t.getBoundingClientRect():(h(t,i),L(t,i),this)}function f(t,i){return void 0==i?s(t).height:s(t,{height:i})}function s(t,i){if(void 0==i)return{width:t.clientWidth,height:t.clientHeight};var e="border-box"===o.css(t,"box-sizing"),n={width:i.width,height:i.height};if(e){var h=l(t);void 0!==n.width&&(n.width=n.width+h.left+h.right),void 0!==n.height&&(n.height=n.height+h.top+h.bottom)}else{var r=w(t);void 0!==n.width&&(n.width=n.width-r.left-r.right),void 0!==n.height&&(n.height=n.height-r.top-r.bottom)}return o.css(t,n),this}function d(t,i){return void 0==i?s(t).width:(s(t,{width:i}),this)}function c(t){var i=s(t),e=w(t);return{left:e.left,top:e.top,width:i.width-e.left-e.right,height:i.height-e.top-e.bottom}}function g(t){var i=t.documentElement,e=t.body,o=Math.max,n=o(i.scrollWidth,e.scrollWidth),l=o(i.clientWidth,e.clientWidth),h=o(i.offsetWidth,e.offsetWidth),r=o(i.scrollHeight,e.scrollHeight),f=o(i.clientHeight,e.clientHeight),s=o(i.offsetHeight,e.offsetHeight);return{width:n<h?l:n,height:r<s?f:r}}function p(t,i){return void 0==i?L(t).height:(L(t,{height:i}),this)}function a(t){if(e.isWindow(t))return{left:0,top:0,right:0,bottom:0};var i=getComputedStyle(t);return{left:C(i.marginLeft),top:C(i.marginTop),right:C(i.marginRight),bottom:C(i.marginBottom)}}function u(t){var i=y(t),e=a(t);return{left:i.left,top:i.top,width:i.width+e.left+e.right,height:i.height+e.top+e.bottom}}function m(t){var i=L(t),e=a(t);return{width:i.width+e.left+e.right,height:i.height+e.top+e.bottom}}function w(t){if(e.isWindow(t))return{left:0,top:0,right:0,bottom:0};var i=getComputedStyle(t);return{left:C(i.paddingLeft),top:C(i.paddingTop),right:C(i.paddingRight),bottom:C(i.paddingBottom)}}function v(t,i){if(void 0===i){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset}}var o=D(t),n=v(o),h=a(t),r=l(o);return b(t,{top:i.top-n.top-h.top-r.top,left:i.left-n.left-h.left-r.left}),this}function W(t,i){if(void 0===i){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}}return v(t,i),L(t,i),this}function b(t,i){if(void 0==i){var e=D(t),n=h(t),r=h(e),f=(a(t),l(e));return{top:n.top-r.top-f.top,left:n.left-r.left-f.left}}var s={top:i.top,left:i.left};return"static"==o.css(t,"position")&&(s.position="relative"),o.css(t,s),this}function y(t,i){if(void 0===i){var e=D(t),o=r(t),n=h(e),f=(a(t),l(e));return{top:o.top-n.top-f.top,left:o.left-n.left-f.left,width:o.width,height:o.height}}return b(t,i),L(t,i),this}function x(t,i){function e(t,i){var e,o,n=t;for(e=o=0;n&&n!=i&&n.nodeType;)e+=n.offsetLeft||0,o+=n.offsetTop||0,n=n.offsetParent;return{x:e,y:o}}var o,n,l,h,r,f,s=t.parentNode,d=e(t,s);return o=d.x,n=d.y,l=t.offsetWidth,h=t.offsetHeight,r=s.clientWidth,f=s.clientHeight,"end"==i?(o-=r-l,n-=f-h):"center"==i&&(o-=r/2-l/2,n-=f/2-h/2),s.scrollLeft=o,s.scrollTop=n,this}function H(t,i){var e="scrollLeft"in t;return void 0===i?e?t.scrollLeft:t.pageXOffset:(e?t.scrollLeft=i:t.scrollTo(i,t.scrollY),this)}function T(t,i){var e="scrollTop"in t;return void 0===i?e?t.scrollTop:t.pageYOffset:(e?t.scrollTop=i:t.scrollTo(t.scrollX,i),this)}function L(t,e){if(void 0==e)return i.isWindow(t)?{width:t.innerWidth,height:t.innerHeight}:i.isDocument(t)?g(document):{width:t.offsetWidth,height:t.offsetHeight};var n="border-box"===o.css(t,"box-sizing"),h={width:e.width,height:e.height};if(!n){var r=w(t),f=l(t);void 0!==h.width&&""!==h.width&&null!==h.width&&(h.width=h.width-r.left-r.right-f.left-f.right),void 0!==h.height&&""!==h.height&&null!==h.height&&(h.height=h.height-r.top-r.bottom-f.top-f.bottom)}return o.css(t,h),this}function z(t,i){return void 0==i?L(t).width:(L(t,{width:i}),this)}function P(){return P}var R,B=/^(?:body|html)$/i,C=i.toPixel,D=e.offsetParent;return i.mixin(P,{borderExtents:l,boundingPosition:h,boundingRect:r,clientHeight:f,clientSize:s,clientWidth:d,contentRect:c,getDocumentSize:g,height:p,marginExtents:a,marginRect:u,marginSize:m,offsetParent:D,paddingExtents:w,pagePosition:v,pageRect:W,relativePosition:b,relativeRect:y,scrollbarWidth:n,scrollIntoView:x,scrollLeft:H,scrollTop:T,size:L,width:z}),function(){function t(t,i,e){return[parseFloat(t[0])*(w.test(t[0])?i/100:1),parseFloat(t[1])*(w.test(t[1])?e/100:1)]}function l(t,i){return parseInt(o.css(t,i),10)||0}function h(t){return 9===t.nodeType?{size:L(t),offset:{top:0,left:0}}:e.isWindow(t)?{size:L(t),offset:{top:T(t),left:H(t)}}:t.preventDefault?{size:{width:0,height:0},offset:{top:t.pageY,left:t.pageX}}:{size:L(t),offset:v(t)}}function r(t){var i=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-x"),e=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-y"),l="scroll"===i||"auto"===i&&t.width<scrollWidth(t.element),h="scroll"===e||"auto"===e&&t.height<scrollHeight(t.element);return{width:h?n():0,height:l?n():0}}function f(t){var i=t||window,o=e.isWindow(i),n=!!i&&9===i.nodeType,l=!o&&!n,h=m(i);return{element:i,isWindow:o,isDocument:n,offset:l?v(t):{left:0,top:0},scrollLeft:H(i),scrollTop:T(i),width:h.width,height:h.height}}function s(e,o){o=i.extend({},o);var n,s,w,b,y,x,H=o.of,T=f(o.within),L=r(T),z=(o.collision||"flip").split(" "),P={};return x=h(H),H.preventDefault&&(o.at="left top"),s=x.size.width,w=x.size.height,b=x.offset,y=i.extend({},b),i.each(["my","at"],function(){var t,i,e=(o[this]||"").split(" ");1===e.length&&(e=g.test(e[0])?e.concat(["center"]):p.test(e[0])?["center"].concat(e):["center","center"]),e[0]=g.test(e[0])?e[0]:"center",e[1]=p.test(e[1])?e[1]:"center",t=a.exec(e[0]),i=a.exec(e[1]),P[this]=[t?t[0]:0,i?i[0]:0],o[this]=[u.exec(e[0])[0],u.exec(e[1])[0]]}),1===z.length&&(z[1]=z[0]),"right"===o.at[0]?y.left+=s:"center"===o.at[0]&&(y.left+=s/2),"bottom"===o.at[1]?y.top+=w:"center"===o.at[1]&&(y.top+=w/2),n=t(P.at,s,w),y.left+=n[0],y.top+=n[1],function(e){var h,r,f=m(e),g=f.width,p=f.height,a=l(e,"marginLeft"),u=l(e,"marginTop"),x=g+a+l(e,"marginRight")+L.width,R=p+u+l(e,"marginBottom")+L.height,B=i.extend({},y),C=t(P.my,f.width,f.height);"right"===o.my[0]?B.left-=g:"center"===o.my[0]&&(B.left-=g/2),"bottom"===o.my[1]?B.top-=p:"center"===o.my[1]&&(B.top-=p/2),B.left+=C[0],B.top+=C[1],h={marginLeft:a,marginTop:u},i.each(["left","top"],function(t,i){W[z[t]]&&W[z[t]][i](B,{targetWidth:s,targetHeight:w,elemWidth:g,elemHeight:p,collisionPosition:h,collisionWidth:x,collisionHeight:R,offset:[n[0]+C[0],n[1]+C[1]],my:o.my,at:o.at,within:T,elem:e})}),o.using&&(r=function(t){var i=b.left-B.left,n=i+s-g,l=b.top-B.top,h=l+w-p,r={target:{element:H,left:b.left,top:b.top,width:s,height:w},element:{element:e,left:B.left,top:B.top,width:g,height:p},horizontal:n<0?"left":i>0?"right":"center",vertical:h<0?"top":l>0?"bottom":"middle"};s<g&&c(i+n)<s&&(r.horizontal="center"),w<p&&c(l+h)<w&&(r.vertical="middle"),d(c(i),c(n))>d(c(l),c(h))?r.important="horizontal":r.important="vertical",o.using.call(this,t,r)}),v(e,i.extend(B,{using:r}))}(e)}var d=Math.max,c=Math.abs,g=/left|center|right/,p=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,w=/%$/,W={fit:{left:function(t,i){var e,o=i.within,n=o.isWindow?o.scrollLeft:o.offset.left,l=o.width,h=t.left-i.collisionPosition.marginLeft,r=n-h,f=h+i.collisionWidth-l-n;i.collisionWidth>l?r>0&&f<=0?(e=t.left+r+i.collisionWidth-l-n,t.left+=r-e):f>0&&r<=0?t.left=n:r>f?t.left=n+l-i.collisionWidth:t.left=n:r>0?t.left+=r:f>0?t.left-=f:t.left=d(t.left-h,t.left)},top:function(t,i){var e,o=i.within,n=o.isWindow?o.scrollTop:o.offset.top,l=i.within.height,h=t.top-i.collisionPosition.marginTop,r=n-h,f=h+i.collisionHeight-l-n;i.collisionHeight>l?r>0&&f<=0?(e=t.top+r+i.collisionHeight-l-n,t.top+=r-e):f>0&&r<=0?t.top=n:r>f?t.top=n+l-i.collisionHeight:t.top=n:r>0?t.top+=r:f>0?t.top-=f:t.top=d(t.top-h,t.top)}},flip:{left:function(t,i){var e,o,n=i.within,l=n.offset.left+n.scrollLeft,h=n.width,r=n.isWindow?n.scrollLeft:n.offset.left,f=t.left-i.collisionPosition.marginLeft,s=f-r,d=f+i.collisionWidth-h-r,g="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,p="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,a=-2*i.offset[0];s<0?(e=t.left+g+p+a+i.collisionWidth-h-l,(e<0||e<c(s))&&(t.left+=g+p+a)):d>0&&(o=t.left-i.collisionPosition.marginLeft+g+p+a-r,(o>0||c(o)<d)&&(t.left+=g+p+a))},top:function(t,i){var e,o,n=i.within,l=n.offset.top+n.scrollTop,h=n.height,r=n.isWindow?n.scrollTop:n.offset.top,f=t.top-i.collisionPosition.marginTop,s=f-r,d=f+i.collisionHeight-h-r,g="top"===i.my[1],p=g?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,a="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,u=-2*i.offset[1];s<0?(o=t.top+p+a+u+i.collisionHeight-h-l,(o<0||o<c(s))&&(t.top+=p+a+u)):d>0&&(e=t.top-i.collisionPosition.marginTop+p+a+u-r,(e>0||c(e)<d)&&(t.top+=p+a+u))}},flipfit:{left:function(){W.flip.left.apply(this,arguments),W.fit.left.apply(this,arguments)},top:function(){W.flip.top.apply(this,arguments),W.fit.top.apply(this,arguments)}}};P.posit=s}(),t.geom=P});
//# sourceMappingURL=sourcemaps/geom.js.map
